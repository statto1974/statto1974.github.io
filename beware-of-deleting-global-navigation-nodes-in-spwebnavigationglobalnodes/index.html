<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes - Toby Statham</title><meta name="description" content="For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/"><link rel="alternate" type="application/atom+xml" href="https://wutek.co.uk/feed.xml"><link rel="alternate" type="application/json" href="https://wutek.co.uk/feed.json"><meta property="og:title" content="Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes"><meta property="og:site_name" content="Toby Statham"><meta property="og:description" content="For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids&hellip;"><meta property="og:url" content="https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@this_is_wutek"><meta name="twitter:title" content="Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes"><meta name="twitter:description" content="For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids&hellip;"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://wutek.co.uk/assets/css/style.css?v=9b8c2c950ce971bb347897f7e2550d3d"><link rel="stylesheet" href="https://wutek.co.uk/assets/css/prism-dark.css?v=4cc85e12ca94c0614c9359a37eb69a0c"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/"},"headline":"Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes","datePublished":"2008-04-09T08:50","dateModified":"2021-05-04T08:35","description":"For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids&hellip;","author":{"@type":"Person","name":"Toby Statham"},"publisher":{"@type":"Organization","name":"Toby Statham"}}</script></head><body><header class="top"><div class="top__logo"><a class="logo" href="https://wutek.co.uk/">Toby Statham</a></div><div class="top__search search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><svg class="search__icon" role="presentation" height="17" width="17"><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#search"/></svg><form action="https://wutek.co.uk/search.html" class="search__form" role="search"><input type="search" name="q" placeholder="Search documentation ..." aria-label="Search" class="search__input js-search-input"></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__button js-search-btn" aria-label="Search"><span>Search</span> <svg role="presentation" focusable="false" height="17" width="17"><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#search"/></svg></button></div></header><main class="main"><div class="main__left"><div class="main__left-inner"><div class="main__left-content"><article class="post"><header><h1 class="post__title">Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes</h1></header><div class="post__entry"><p>For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects.</p><p>Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids of 1000, 1002 and 1025 respectively.</p><p>The problem occurs if you delete Quick Launch or SharePoint Top Navigation nodes. Even if you then add them back in a new ID is generated and SPWeb.Navigation.TopNavigationBar looks for child nodes under a node with an Id of 1002 (This is hard coded).</p><p>Through the API this means that SPWeb.Navigation.TopNavigationBar will always be null and through the SharePoint UI an error will be returned to the user ("Value does not exist in that range").</p><p>The only ways I have found to fix this is to delete and re-create the site or (Microsoft please close your ears) get the site id and web id and query the NavNodes table in the content database the site collection sits in and add the following records</p><table border="1" cellspacing="1" cellpadding="1" width="400"><tbody><tr><td><h6>SiteId</h6></td><td><h6>WebId</h6></td><td><h6>Eid</h6></td><td><h6>EidParent</h6></td><td><h6>NumChildren</h6></td><td><h6>RankChild</h6></td><td><h6>ElementType</h6></td><td><h6>Url</h6></td><td><h6>DocId</h6></td><td><h6>Name</h6></td><td><h6>DateLastModified</h6></td><td><h6>NodeMetaInfo</h6></td><td><h6>NonNavPage</h6></td><td><h6>NavSequence</h6></td><td><h6>ChildOfSequence</h6></td></tr><tr><td><h6>C803FD13-27FA-475F-909C-2CE5B2048E1B</h6></td><td><h6>A31E8093-1505-4E1C-B7CC-04D6B952A33F</h6></td><td><h6>1000</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>NULL</h6></td><td><h6>A31414EE-953B-44CC-A37E-4D5D643B002A</h6></td><td><h6>Home</h6></td><td><h6>2008-04-04 11:28:21.000</h6></td><td><h6>NULL</h6></td><td><h6>False</h6></td><td><h6>False</h6></td><td><h6>False</h6></td></tr><tr><td><h6>C803FD13-27FA-475F-909C-2CE5B2048E1B</h6></td><td><h6>A31E8093-1505-4E1C-B7CC-04D6B952A33F</h6></td><td><h6>1002</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>2</h6></td><td><h6>1</h6></td><td><h6> </h6></td><td><h6>NULL</h6></td><td><h6>SharePoint Top Navigation</h6></td><td><h6>2008-04-04 11:28:21.000</h6></td><td><h6>NULL</h6></td><td><h6>False</h6></td><td><h6>True</h6></td><td><h6>False</h6></td></tr><tr><td><h6>C803FD13-27FA-475F-909C-2CE5B2048E1B</h6></td><td><h6>A31E8093-1505-4E1C-B7CC-04D6B952A33F</h6></td><td><h6>1025</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>1</h6></td><td><h6>1</h6></td><td><h6> </h6></td><td><h6>NULL</h6></td><td><h6>Quick Launch</h6></td><td><h6>2008-04-04 11:28:21.000</h6></td><td><h6>NULL</h6></td><td><h6>True</h6></td><td><h6>True</h6></td><td><h6>False</h6></td></tr></tbody></table></div><footer><div class="post__footer-top"><div class="post__meta"><time datetime="2008-04-09T08:50">April 9, 2008 </time>by <a href="https://wutek.co.uk/authors/toby-statham/" rel="author" title="Toby Statham">Toby Statham </a><span>Updated on: <time datetime="2021-05-04T08:35">May 4, 2021</time></span></div><div class="post__share"><button class="post__share-button js-post__share-button" aria-label="Share"><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#share"></use></svg></button><div class="post__share-popup js-post__share-popup"></div></div></div><div class="post__footer-bottom"><ul class="post__tag"><li><a href="https://wutek.co.uk/tags/navigation/">Navigation</a></li></ul><div class="post__bio"><p><a href="https://wutek.co.uk/authors/toby-statham/"><strong>Toby Statham</strong> </a>Independent Microsoft 365 / SharePoint / Power Platform Specialist and an associate consultant at Aiimi, an Information Management company</p></div></div></footer></article><nav><ul class="posts-nav"><li class="posts-nav__prev"><span>Previous: </span><a href="https://wutek.co.uk/invalid-object-name-groups-when-using-psconfig/" class="invert" rel="prev" title="Invalid object name &#x27;Groups&#x27; when using PSCONFIG">Invalid object name &#x27;Groups&#x27; when using PSCONFIG</a></li><li class="posts-nav__next"><span>Next: </span><a href="https://wutek.co.uk/the-hidden-user-information-list-and-the-email-field/" class="invert" rel="next" title="The hidden User Information List and the Email field">The hidden User Information List and the Email field</a></li></ul></nav><div class="post-comments" id="post-comments"><div id="disqus_thread"></div><script>var disqus_config = function () {
                             this.page.url = 'https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/';
                     		this.page.identifier = '16';
                         };
                     
                         var disqus_loaded = false;
                     
                         function publiiLoadDisqus() {
                             if(disqus_loaded) {
                                 return false;
                             }
                     
                             var top = document.getElementById('disqus_thread').offsetTop;
                     
                             if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                                 disqus_loaded = true;
                     
                                 (function () {
                                     var d = document, s = d.createElement('script');
                                     s.src = 'https://wutek.disqus.com/embed.js';
                                     s.setAttribute('data-timestamp', +new Date());
                                     (d.head || d.body).appendChild(s);
                                 })();
                             }
                         }
                     
                         publiiLoadDisqus();
                     
                         window.onscroll = function() {
                             publiiLoadDisqus();
                         };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div><aside class="main__left-aside"><div class="main__left-aside__inner"><h3>On this page</h3><nav class="aside-toc" id="aside-toc"></nav></div></aside></div></div><div class="main__right"><div class="main__right-inner"><div class="footer main__right-footer"><div class="footer__copy">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></div></div></div></div></main><footer class="footer"><div class="footer__wrap"><div class="footer__inner"><div class="footer__copy">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></div></div></div></footer><div class="post__progress" id="js-post__progress" aria-hidden="true"></div><div class="newsletter-popup" data-show-on-scroll="800px" data-show-after-time="5000ms"><button class="btn white newsletter-popup__close">&times;</button><h3>Subscribe</h3><p>Get the latest news, updates and more delivered directly to your email inbox</p><form>...</form></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',        
        submenuWidth: 300,        
        mobileMenuExpandableSubmenus: true,
        isHoverMenu: false,
        ariaButtonAttribute: 'aria-expanded',
   };</script><script src="https://wutek.co.uk/assets/js/html-contents.min.js?v=169077c370ab8ca62b029845f80f7fd5" defer="defer"></script><script>document.addEventListener("DOMContentLoaded", function(event) {
            htmlContents('#aside-toc', {
                area: '.post__entry',
                top: 2,
                bottom: 3,
                listType: 'o',
                filter: function(arr) {
                    return !arr.matches('.noOutline')
                },
                addIds: true,
                addLinks: true
            });

            setTimeout(function() {
                handleActiveClass('#aside-toc');
            }, 0);
        })</script><script defer="defer" src="https://wutek.co.uk/assets/js/scripts.min.js?v=2e5cce97094c516b8f7e6af7e7cd3e09"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://wutek.co.uk/assets/js/prism.js?v=277309e26a038bf312a7e8aa239cfbd8"></script><script defer="defer" src="https://wutek.co.uk/assets/js/prism-line-numbers.min.js?v=13275d3ac10d7028cf6a6f5da276f68c"></script><script defer="defer" src="https://wutek.co.uk/assets/js/prism-copy-to-clipboard.min.js?v=fabfc3fd9af83cda5208ba2e9f9ed238"></script></body></html>