<!DOCTYPE html><html lang="en-gb" data-theme="green-gray"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes - Toby Statham</title><meta name="description" content="For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids of 1000, 1002 and 1025 respectively. The problem occurs if you delete Quick Launch or SharePoint Top Navigation nodes. Even if you then add them&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/"><meta property="og:title" content="Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes"><meta property="og:site_name" content="Toby Statham"><meta property="og:description" content="For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids of 1000, 1002 and 1025 respectively. The problem occurs if you delete Quick Launch or SharePoint Top Navigation nodes. Even if you then add them&hellip;"><meta property="og:url" content="https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@this_is_wutek"><meta name="twitter:title" content="Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes"><meta name="twitter:description" content="For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids of 1000, 1002 and 1025 respectively. The problem occurs if you delete Quick Launch or SharePoint Top Navigation nodes. Even if you then add them&hellip;"><link rel="alternate" type="application/atom+xml" href="https://wutek.co.uk/feed.xml"><link rel="alternate" type="application/json" href="https://wutek.co.uk/feed.json"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><style>:root {
               --body-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
               --heading-font: 'Playfair Display', serif;
               --logo-font: var(--body-font);
               --menu-font: var(--heading-font);
            }</style><link rel="stylesheet" href="https://wutek.co.uk/assets/css/style.css?v=076b19ff0048426f36c3ff3f27f97211"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://wutek.co.uk/beware-of-deleting-global-navigation-nodes-in-spwebnavigationglobalnodes/"},"headline":"Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes","datePublished":"2008-04-09T08:50","dateModified":"2021-05-04T08:35","description":"For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects. Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids of 1000, 1002 and 1025 respectively. The problem occurs if you delete Quick Launch or SharePoint Top Navigation nodes. Even if you then add them&hellip;","author":{"@type":"Person","name":"Toby Statham"},"publisher":{"@type":"Organization","name":"Toby Statham"}}</script></head><body><header class="header" id="js-header"><div><a class="logo" href="https://wutek.co.uk/">Toby Statham</a><div class="search"><div class="search__overlay js-search-overlay"><form action="https://wutek.co.uk/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="Search articles..." aria-label="Search input" autofocus="autofocus"> <button class="search__submit" aria-label="Search">Search</button></form></div><button class="search__btn js-search-btn" aria-label="Search"><svg height="17" width="17"><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#search"/></svg></button></div></div></header><main><article class="post"><header class="post__inner post__header--centered"><h1 class="h0 post__title">Beware of deleting Global Navigation nodes in SPWeb.Navigation.GlobalNodes</h1><div class="post__meta"><div class="post__meta__author"><div><a href="https://wutek.co.uk/authors/toby-statham/" class="post__author">Toby Statham</a> <time datetime="2008-04-09T08:50" class="post__date">April 9, 2008</time></div></div></div></header><div class="post__body"><div class="post__inner"><div class="post__entry"><p>For a standard team site (STS#0) the GlobalNodes SPNavigationNodesCollection will contain three SPNavigationNode objects.</p><p>Home, Quick Launch and SharePoint Top Navigation Bar, these each have Ids of 1000, 1002 and 1025 respectively.</p><p>The problem occurs if you delete Quick Launch or SharePoint Top Navigation nodes. Even if you then add them back in a new ID is generated and SPWeb.Navigation.TopNavigationBar looks for child nodes under a node with an Id of 1002 (This is hard coded).</p><p>Through the API this means that SPWeb.Navigation.TopNavigationBar will always be null and through the SharePoint UI an error will be returned to the user ("Value does not exist in that range").</p><p>The only ways I have found to fix this is to delete and re-create the site or (Microsoft please close your ears) get the site id and web id and query the NavNodes table in the content database the site collection sits in and add the following records</p><table border="1" cellspacing="1" cellpadding="1" width="400"><tbody><tr><td><h6>SiteId</h6></td><td><h6>WebId</h6></td><td><h6>Eid</h6></td><td><h6>EidParent</h6></td><td><h6>NumChildren</h6></td><td><h6>RankChild</h6></td><td><h6>ElementType</h6></td><td><h6>Url</h6></td><td><h6>DocId</h6></td><td><h6>Name</h6></td><td><h6>DateLastModified</h6></td><td><h6>NodeMetaInfo</h6></td><td><h6>NonNavPage</h6></td><td><h6>NavSequence</h6></td><td><h6>ChildOfSequence</h6></td></tr><tr><td><h6>C803FD13-27FA-475F-909C-2CE5B2048E1B</h6></td><td><h6>A31E8093-1505-4E1C-B7CC-04D6B952A33F</h6></td><td><h6>1000</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>NULL</h6></td><td><h6>A31414EE-953B-44CC-A37E-4D5D643B002A</h6></td><td><h6>Home</h6></td><td><h6>2008-04-04 11:28:21.000</h6></td><td><h6>NULL</h6></td><td><h6>False</h6></td><td><h6>False</h6></td><td><h6>False</h6></td></tr><tr><td><h6>C803FD13-27FA-475F-909C-2CE5B2048E1B</h6></td><td><h6>A31E8093-1505-4E1C-B7CC-04D6B952A33F</h6></td><td><h6>1002</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>2</h6></td><td><h6>1</h6></td><td><h6> </h6></td><td><h6>NULL</h6></td><td><h6>SharePoint Top Navigation</h6></td><td><h6>2008-04-04 11:28:21.000</h6></td><td><h6>NULL</h6></td><td><h6>False</h6></td><td><h6>True</h6></td><td><h6>False</h6></td></tr><tr><td><h6>C803FD13-27FA-475F-909C-2CE5B2048E1B</h6></td><td><h6>A31E8093-1505-4E1C-B7CC-04D6B952A33F</h6></td><td><h6>1025</h6></td><td><h6>0</h6></td><td><h6>0</h6></td><td><h6>1</h6></td><td><h6>1</h6></td><td><h6> </h6></td><td><h6>NULL</h6></td><td><h6>Quick Launch</h6></td><td><h6>2008-04-04 11:28:21.000</h6></td><td><h6>NULL</h6></td><td><h6>True</h6></td><td><h6>True</h6></td><td><h6>False</h6></td></tr></tbody></table></div><footer class="post__footer"><div class="post__updated">Updated: <time datetime="2021-05-04T08:35">May 4, 2021</time></div><div class="post__tag"><span>Tags:</span><ul class="post__tag__list"><li><a href="https://wutek.co.uk/tags/navigation/" title="Navigation">Navigation</a></li></ul></div><div class="post__meta"><div class="post__meta__share"><h3>Share this:</h3></div></div></footer></div></div></article><div class="section post__related"><div class="wrapper"><h3 class="h4 section__title">You may also like:</h3><div class="card-container card-container--col4"><article class="card"><div class="card__content"><h2 class="card__title"><a href="https://wutek.co.uk/adding-metadata-navigation-and-per-location-setting-programmatically-to-a-list/" class="invert">Adding Metadata navigation and per-location setting programmatically to a list</a></h2><p>This turned out to be harder than I...</p><footer class="card__footer"><time datetime="2013-03-21T11:57">March 21, 2013 </time><a href="https://getpocket.com/save?url=https%3A%2F%2Fwutek.co.uk%2Fadding-metadata-navigation-and-per-location-setting-programmatically-to-a-list%2F&title=Adding%20Metadata%20navigation%20and%20per-location%20setting%20programmatically%20to%20a%20list" class="btn btn--clean card__readlater js-share" aria-label="Read later"><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#readlater"/></svg></a></footer></div></article></div></div></div></main><footer class="footer section section--lightest"><div class="footer__inner"><a class="logo footer__logo" href="https://wutek.co.uk/">Toby Statham</a><div class="footer__copyright"><p>Powered by Publii</p></div></div><button class="footer__bttop js-scroll-to-top" aria-label="Back to top"><svg><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#toparrow"/></svg></svg></button></footer><script defer="defer" src="https://wutek.co.uk/assets/js/scripts.min.js?v=11cb42b202c1c2462a7002b62194e351"></script><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>