<!DOCTYPE html><html lang="en-gb" data-theme="green-gray"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>&quot;Attempted to read write to protected memory&quot; error on NLB Web Frontend Server - Toby Statham</title><meta name="description" content="We were getting an error on one of our Load balanced web servers. First of all we got 'Attempted to read write to protected memory' error followed by the 'The path specified cannot be used at this time' which is then logged every minute in the event viewer on our server."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://wutek.co.uk/attempted-to-read-write-to-protected-memory-error-on-nlb-web-frontend-server/"><meta property="og:title" content="'Attempted to read write to protected memory' error on NLB Web Frontend Server"><meta property="og:site_name" content="Toby Statham"><meta property="og:description" content="We were getting an error on one of our Load balanced web servers. First of all we got 'Attempted to read write to protected memory' error followed by the 'The path specified cannot be used at this time' which is then logged every minute in the event viewer on our server."><meta property="og:url" content="https://wutek.co.uk/attempted-to-read-write-to-protected-memory-error-on-nlb-web-frontend-server/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@this_is_wutek"><meta name="twitter:title" content="'Attempted to read write to protected memory' error on NLB Web Frontend Server"><meta name="twitter:description" content="We were getting an error on one of our Load balanced web servers. First of all we got 'Attempted to read write to protected memory' error followed by the 'The path specified cannot be used at this time' which is then logged every minute in the event viewer on our server."><link rel="alternate" type="application/atom+xml" href="https://wutek.co.uk/feed.xml"><link rel="alternate" type="application/json" href="https://wutek.co.uk/feed.json"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><style>:root {
               --body-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
               --heading-font: 'Playfair Display', serif;
               --logo-font: var(--body-font);
               --menu-font: var(--heading-font);
            }</style><link rel="stylesheet" href="https://wutek.co.uk/assets/css/style.css?v=076b19ff0048426f36c3ff3f27f97211"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://wutek.co.uk/attempted-to-read-write-to-protected-memory-error-on-nlb-web-frontend-server/"},"headline":"\"Attempted to read write to protected memory\" error on NLB Web Frontend Server","datePublished":"2007-11-26T12:22","dateModified":"2021-05-04T08:35","description":"We were getting an error on one of our Load balanced web servers. First of all we got \"Attempted to read write to protected memory\" error followed by the \"The path specified cannot be used at this time\" which is then logged every minute in the event viewer on our server.","author":{"@type":"Person","name":"Toby Statham"},"publisher":{"@type":"Organization","name":"Toby Statham"}}</script></head><body><header class="header" id="js-header"><div><a class="logo" href="https://wutek.co.uk/">Toby Statham</a><div class="search"><div class="search__overlay js-search-overlay"><form action="https://wutek.co.uk/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="Search articles..." aria-label="Search input" autofocus="autofocus"> <button class="search__submit" aria-label="Search">Search</button></form></div><button class="search__btn js-search-btn" aria-label="Search"><svg height="17" width="17"><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#search"/></svg></button></div></div></header><main><article class="post"><header class="post__inner post__header--centered"><h1 class="h0 post__title">&quot;Attempted to read write to protected memory&quot; error on NLB Web Frontend Server</h1><div class="post__meta"><div class="post__meta__author"><div><a href="https://wutek.co.uk/authors/toby-statham/" class="post__author">Toby Statham</a> <time datetime="2007-11-26T12:22" class="post__date">November 26, 2007</time></div></div></div></header><div class="post__body"><div class="post__inner"><div class="post__entry"><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';">We were getting an error on one of our Load balanced web servers.</span></p><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';">First of all we got "Attempted to read write to protected memory" error followed by the "The path specified cannot be used at this time" which is then logged every minute in the event viewer on our server.</span></p><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">This then ends up using all the resources on that server, which then makes the server become unavailable. Once the machine becomes unavailable it will move onto the next server and kill that one.</span></span></p><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">This was reported to Microsoft support and they identified it as a bug that will be fixed in SP1.</span></span></p><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">In the meantime the following will need to be done to work around this problem</span></span></p><ol><li><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">Install the following hotfix 923028</span></span></span></li><li><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"></span></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">Retype the password for the search service from The central administrator page.</span></span></span></li><li><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">Run “services.msc” and </span></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">select the Windows SharePoint Services Timer<br></span></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">Make sure the service is running with a MOSS service account, </span></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">if it is running with MOSS services account then </span></span></span><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">stop the service, retype the password and then start the service account again</span></span></span></li><li><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">Install / script a tool that automatically restarts the Windows SharePoint Services Timer when the following Event IDs are raised; 6398, 6482 and 7076. Microsoft Support maybe able to provide you with this tool if you raise a support request with them.</span></span></span></li></ol><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"> This is a particularly scary bug to be appearing in a "Production" ready product, especially as it is only happening in the farm environment and can take down you whole farm.</span></span></span></p><p><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';"><span style="font-size:10pt;font-family:'Verdana','sans-serif';">I believe there needs to be more information on the whole way SharePoint propagates between servers in a farm, there seems to be little understanding of it presently.</span></span></span></p></div><footer class="post__footer"><div class="post__updated">Updated: <time datetime="2021-05-04T08:35">May 4, 2021</time></div><div class="post__tag"><span>Tags:</span><ul class="post__tag__list"><li><a href="https://wutek.co.uk/tags/bugs/" title="Bugs">Bugs</a></li></ul></div><div class="post__meta"><div class="post__meta__share"><h3>Share this:</h3></div></div></footer></div></div></article><div class="section post__related"><div class="wrapper"><h3 class="h4 section__title">You may also like:</h3><div class="card-container card-container--col4"><article class="card"><div class="card__content"><h2 class="card__title"><a href="https://wutek.co.uk/powerpivot-management-dashboard-error-with-infrastructure-server-health-report/" class="invert">PowerPivot Management Dashboard: Error with &quot;Infrastructure - Server Health&quot; report</a></h2><p>When loading this page in Central Administration, I...</p><footer class="card__footer"><time datetime="2013-09-27T10:41">September 27, 2013 </time><a href="https://getpocket.com/save?url=https%3A%2F%2Fwutek.co.uk%2Fpowerpivot-management-dashboard-error-with-infrastructure-server-health-report%2F&title=PowerPivot%20Management%20Dashboard%3A%20Error%20with%20%22Infrastructure%20-%20Server%20Health%22%20report" class="btn btn--clean card__readlater js-share" aria-label="Read later"><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#readlater"/></svg></a></footer></div></article><article class="card"><div class="card__content"><h2 class="card__title"><a href="https://wutek.co.uk/finding-the-smtp-server-address-through-code-in-sharepoint-2010/" class="invert">Finding the SMTP server address through code in SharePoint 2010</a></h2><p>If anyone knows a better way then let...</p><footer class="card__footer"><time datetime="2011-02-13T11:23">February 13, 2011 </time><a href="https://getpocket.com/save?url=https%3A%2F%2Fwutek.co.uk%2Ffinding-the-smtp-server-address-through-code-in-sharepoint-2010%2F&title=Finding%20the%20SMTP%20server%20address%20through%20code%20in%20SharePoint%202010" class="btn btn--clean card__readlater js-share" aria-label="Read later"><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#readlater"/></svg></a></footer></div></article><article class="card"><div class="card__content"><h2 class="card__title"><a href="https://wutek.co.uk/using-the-bdc-to-populate-user-profiles-from-a-sql-server-database-part-two/" class="invert">Using the BDC to populate user profiles from a SQL Server database - Part Two</a></h2><p>This is the second part of a two...</p><footer class="card__footer"><time datetime="2007-11-02T09:46">November 2, 2007 </time><a href="https://getpocket.com/save?url=https%3A%2F%2Fwutek.co.uk%2Fusing-the-bdc-to-populate-user-profiles-from-a-sql-server-database-part-two%2F&title=Using%20the%20BDC%20to%20populate%20user%20profiles%20from%20a%20SQL%20Server%20database%20-%20Part%20Two" class="btn btn--clean card__readlater js-share" aria-label="Read later"><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#readlater"/></svg></a></footer></div></article></div></div></div></main><footer class="footer section section--lightest"><div class="footer__inner"><a class="logo footer__logo" href="https://wutek.co.uk/">Toby Statham</a><div class="footer__copyright"><p>Powered by Publii</p></div></div><button class="footer__bttop js-scroll-to-top" aria-label="Back to top"><svg><svg><use xlink:href="https://wutek.co.uk/assets/svg/svg-map.svg#toparrow"/></svg></svg></button></footer><script defer="defer" src="https://wutek.co.uk/assets/js/scripts.min.js?v=11cb42b202c1c2462a7002b62194e351"></script><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>